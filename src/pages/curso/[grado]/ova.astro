---
import fs from 'fs/promises';
import path from 'path';
import OVAWrapper from '../../../components/ova/OVAWrapper.jsx';

export async function getStaticPaths() {
  const dataDir = path.resolve('./src/data/ova');
  const files = await fs.readdir(dataDir);

  return files.map((file) => ({
    params: { grado: file.replace('.json', '') },
  }));
}

const { grado } = Astro.params;
const filePath = path.resolve('./src/data/ova', `${grado}.json`);

let data = { items: [], target: 'objeto' };

try {
  const file = await fs.readFile(filePath, 'utf-8');
  data = JSON.parse(file);
} catch (err) {
  console.error('Error cargando JSON:', err);
}
---

<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <title>OVA - Grado {grado}</title>
  </head>
  <body class="p-4 font-sans bg-white min-h-screen">
    <h1 class="text-2xl font-bold mb-4">Curso- {grado}</h1>
    <OVAWrapper client:load items={data.items} target={data.target} />

  </body>
</html>
